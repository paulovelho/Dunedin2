import{$a as b,A as B,B as r,C as o,D as C,E as L,F as m,G as N,H as W,I as d,J as S,K as P,L as z,M as H,N as V,Na as Y,O as R,P as u,Q as J,Ya as Z,Z as K,_ as U,_a as w,ab as $,d as j,e as E,eb as c,f as T,h as y,i as G,j as v,l,m as O,n as q,o as D,p as A,q as _,qa as X,s,t as Q,y as x,z as p}from"./chunk-N3QAHXRB.js";var rt=()=>["btn","label-margin","w-100"],k=(()=>{let e=class e{constructor(){this.debounceTimeMs=500,this.minCharacters=4,this.searchSubject=new j,this.loading=!1,this.updateQuery=new _}ngOnInit(){this.searchSubject.pipe(T(this.debounceTimeMs)).subscribe(t=>{this.updateQuery.emit(t)})}ngOnDestroy(){this.searchSubject.complete()}queryChanged(){this.query&&this.query.length>this.minCharacters&&this.searchSubject.next(this.query)}refresh(){this.updateQuery.emit(this.query)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=l({type:e,selectors:[["app-search-input"]],inputs:{loading:"loading"},outputs:{updateQuery:"updateQuery"},standalone:!0,features:[u],decls:9,vars:6,consts:[["title","Search","icon","fa-search",3,"loading","showClose"],["actions",""],[1,"transition",3,"click"],[1,"fa","fa-refresh"],[1,"row"],[1,"col-sm-9"],["id","search-input","label","Search",3,"valueChange","value"],[1,"col-sm-3"],["type","primary","caption","Search","icon","fa-search",3,"action"]],template:function(i,n){i&1&&(r(0,"app-window",0)(1,"span",1)(2,"a",2),m("click",function(){return n.refresh()}),C(3,"i",3),o()(),r(4,"div",4)(5,"div",5)(6,"app-input",6),V("valueChange",function(g){return H(n.query,g)||(n.query=g),g}),o()(),r(7,"div",7)(8,"app-button",8),m("action",function(){return n.refresh()}),o()()()()),i&2&&(p("loading",n.loading)("showClose",!1),s(6),z("value",n.query),s(2),B(J(5,rt)))},dependencies:[c,w,b,$]});let a=e;return a})();var I=(()=>{let e=class e extends Y{constructor(t){super(t)}getAll(){let t=this.url("/gags");return this.get(t).pipe(this.defaultMap)}getById(t){let i=this.url("/gag/:id").params({id:t});return this.get(i).pipe(this.defaultMap)}update(t){let i=t.id,n=this.url("/gags/:id").params({id:i});return this.put(n,t)}insert(t){let i=this.url("/gags");return this.post(i,t)}search(t,i){return this.post(this.url("/search"),{q:t,page:i}).pipe(this.defaultMap)}author(t,i){return this.post(this.url("/author"),{q:t,page:i}).pipe(this.defaultMap)}};e.\u0275fac=function(i){return new(i||e)(v(A))},e.\u0275prov=y({token:e,factory:e.\u0275fac});let a=e;return a})();var M=(()=>{let e=class e{constructor(t){this.api=t,this.page=0}getObjFromData(t){return{id:t.id,content:t.content,author:t.author,location:t.location,origin:t.origin,gag_hash:t.gag_hash,highlight_date:t.highlight_date,used_in:t.used_in,created_at:t.created_at,updated_at:t.updated_at}}searchGag(t){return this.query=t,this.page=0,this.callSearchGagsApi()}getAuthor(t){return this.api.author(t)}nextPage(){return this.page=this.page+1,this.callSearchGagsApi()}callSearchGagsApi(){return console.info("searching page ["+this.page+"]: ",this.query),this.api.search(this.query,this.page).pipe(E(t=>{this.total=t.total;let i=t.data.map(n=>this.getObjFromData(n));return{total:t.total,content:i}}))}};e.\u0275fac=function(i){return new(i||e)(v(I))},e.\u0275prov=y({token:e,factory:e.\u0275fac,providedIn:"root"});let a=e;return a})();var tt=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=l({type:e,selectors:[["app-gag-item"]],inputs:{item:"item"},standalone:!0,features:[u],decls:12,vars:5,consts:[["header",""],["body",""],[1,"content"],[1,"author"],[1,"location"],[1,"date"]],template:function(i,n){i&1&&(r(0,"app-card")(1,"div",0),d(2),o(),r(3,"div",1)(4,"p",2),d(5),o(),r(6,"p",3),d(7),o(),r(8,"p",4),d(9),o(),r(10,"p",5),d(11),o()()()),i&2&&(s(2),P(" #",n.item==null?null:n.item.id," "),s(3),S(n.item==null?null:n.item.content),s(2),P("~ ",n.item==null?null:n.item.author,""),s(2),S(n.item==null?null:n.item.location),s(2),S(n.item==null?null:n.item.highlight_date))},dependencies:[c,Z],styles:[".content[_ngcontent-%COMP%]{font-size:16px}.author[_ngcontent-%COMP%]{font-size:14px;text-align:right;font-variant:small-caps}.location[_ngcontent-%COMP%], .date[_ngcontent-%COMP%]{font-size:12px;text-align:right}"]});let a=e;return a})();function lt(a,e){if(a&1&&C(0,"app-gag-item",5),a&2){let F=e.$implicit;p("item",F)}}function mt(a,e){if(a&1){let F=L();r(0,"div",2)(1,"app-button",6),m("action",function(){q(F);let i=N();return D(i.nextPage.emit())}),o()()}}var et=(()=>{let e=class e{constructor(){this.loading=!1,this.list=[],this.nextPage=new _}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=l({type:e,selectors:[["app-gag-list"]],inputs:{loading:"loading",list:"list",total:"total"},outputs:{nextPage:"nextPage"},standalone:!0,features:[u],decls:5,vars:6,consts:[["icon","fa-search",3,"title","loading","showClose"],[1,"row"],[1,"col-sm-12"],[3,"item",4,"ngFor","ngForOf"],["class","col-sm-12",4,"ngIf"],[3,"item"],["icon","fa-forward","caption","Next Page",3,"action"]],template:function(i,n){i&1&&(r(0,"app-window",0)(1,"div",1)(2,"div",2),x(3,lt,1,1,"app-gag-item",3),o(),x(4,mt,2,0,"div",4),o()()),i&2&&(W("title","",n.total," results found"),p("loading",n.loading)("showClose",!1),s(3),p("ngForOf",n.list),s(),p("ngIf",n.list&&n.total&&n.total>n.list.length))},dependencies:[c,K,U,w,b,tt]});let a=e;return a})();var it=(()=>{let e=class e{constructor(t){this.service=t,this.loading=!1,this.data=[]}search(t){console.info("searching ",t),this.loading=!0,this.service.searchGag(t).subscribe({next:i=>{this.total=i.total,this.data=i.content,this.loading=!1}})}nextPage(){this.service.nextPage().subscribe({next:t=>{this.data=this.data.concat(t.content)}})}};e.\u0275fac=function(i){return new(i||e)(Q(M))},e.\u0275cmp=l({type:e,selectors:[["app-gag-home"]],standalone:!0,features:[R([M,I]),u],decls:2,vars:4,consts:[[3,"updateQuery","loading"],[3,"nextPage","total","loading","list"]],template:function(i,n){i&1&&(r(0,"app-search-input",0),m("updateQuery",function(g){return n.search(g)}),o(),r(1,"app-gag-list",1),m("nextPage",function(){return n.nextPage()}),o()),i&2&&(p("loading",n.loading),s(),p("total",n.total)("loading",n.loading)("list",n.data))},dependencies:[c,k,et]});let a=e;return a})();var nt=[{path:"",component:it}];var zt=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=O({type:e}),e.\u0275inj=G({imports:[X.forChild(nt)]});let a=e;return a})();export{zt as GagsModule};
